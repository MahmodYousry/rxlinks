<div class="content white-content py-3">
  <div class="container mb-4 d-flex align-items-center gap-2 flex-wrap">
    <p-togglebutton
      [ngModel]="checked()"
      (onChange)="onThemeToggle($event)"
      onLabel="Dark"
      offLabel="Light"
      onIcon="pi pi-moon"
      offIcon="pi pi-sun"
      class="w-24"
      ariaLabel="Toggle dark mode"
    />
    @if (recentLinks().length > 0) {
    <p-button
      icon="pi pi-trash"
      label="Clear recent"
      severity="secondary"
      styleClass="clear-recent-btn"
      (onClick)="onClearRecent()"
      ariaLabel="Clear recently used links"
    />
    }
    <p-button
      icon="pi pi-chevron-down"
      label="Expand all"
      severity="secondary"
      (onClick)="expandAll()"
      ariaLabel="Expand all categories"
    />
    <p-button
      icon="pi pi-chevron-up"
      label="Collapse all"
      severity="secondary"
      (onClick)="collapseAll()"
      ariaLabel="Collapse all categories"
    />
  </div>
  <app-search (searchValue)="onSearchValueChange($event)"></app-search>

  @if (recentLinks().length > 0) {
  <div class="container mb-4">
    <h3 class="category-header">Recently used</h3>
    <div
      class="d-flex justify-content-md-start justify-content-between align-items-center flex-wrap gap-3"
    >
      @for (link of recentLinks(); track link.url + link.title) {
      <app-link
        [title]="link.title"
        [url]="link.url"
        [icon]="link.img"
        target="_blank"
        (linkClick)="onLinkUsed(link)"
      ></app-link>
      }
    </div>
  </div>
  }

  @if (noResults()) {
  <div class="container mb-4">
    <p class="text-muted mb-0">No results found.</p>
  </div>
  } @else {
  @for (char of categories; track char) {
  <div class="container mb-4 category-block">
    <button
      type="button"
      class="category-header category-header-btn"
      (click)="toggleCategory(char)"
      [attr.aria-expanded]="!isCategoryCollapsed(char)"
      [attr.aria-controls]="'category-' + char"
      [id]="'header-' + char"
    >
      <span class="category-header-chevron pi" [class.pi-chevron-down]="!isCategoryCollapsed(char)" [class.pi-chevron-right]="isCategoryCollapsed(char)" aria-hidden="true"></span>
      <span>{{ char }}</span>
    </button>
    @if (!isCategoryCollapsed(char)) {
    <div
      [id]="'category-' + char"
      role="region"
      [attr.aria-labelledby]="'header-' + char"
      class="d-flex justify-content-md-start justify-content-between align-items-center flex-wrap gap-3"
    >
      @for (link of links(); track link.url + link.title) { @if (link.category === char) {
      <app-link
        [title]="link.title"
        [url]="link.url"
        [icon]="link.img"
        target="_blank"
        (linkClick)="onLinkUsed(link)"
      ></app-link>
      } }
    </div>
    }
  </div>
  }
  }
</div>
